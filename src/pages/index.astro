---
import BaseLayout from "../layouts/BaseLayout.astro";
import { pb, type Post, getPbImageURL } from "../lib/pocketbase";
import TreatmentProcess from "../components/TreatmentProcess.astro";
import { Image } from "astro:assets";
import LeadCaptureForm from "../components/LeadCaptureForm.jsx";
import FAQ from "../components/FAQ.jsx";

const title = "Fizyoterapist Ezgi Acem | SaÄŸlÄ±klÄ± YaÅŸam ve Rehabilitasyon";

// Fetch recent 6 posts
let latestPosts: Post[] = [];
try {
  // Fetch recent 3 posts
  const result = await pb.collection("posts").getList<Post>(1, 3, {
    sort: "-published_date",
  });
  latestPosts = result.items;
} catch (e) {
  console.error("Error fetching posts:", e);
}
---

<BaseLayout
  title="Adana Pediatrik Fizyoterapist Ezgi Acem | Duyu BÃ¼tÃ¼nleme ve Rehabilitasyon"
  description="Adana'da uzman pediatrik fizyoterapist desteÄŸi. Duyu bÃ¼tÃ¼nleme terapisi, riskli bebek takibi ve Ã§ocuk fizyoterapisi ile Ã§ocuÄŸunuzun geliÅŸimini destekleyin."
>
  <!-- Hero Section -->
  <!-- Hero Section -->
  <div
    class="min-h-screen flex flex-col items-center justify-start md:justify-center text-center px-4 relative overflow-hidden pt-36 md:pt-20"
  >
    <!-- Unified Background with Mask -->
    <div
      class="absolute inset-0 -z-10 pointer-events-none overflow-hidden"
      style="mask-image: linear-gradient(to bottom, black 85%, transparent 100%); -webkit-mask-image: linear-gradient(to bottom, black 85%, transparent 100%);"
    >
      <!-- Gradient -->
      <div
        class="absolute inset-0 bg-gradient-to-b from-transparent to-white/50"
      >
      </div>
    </div>

    <div class="container mx-auto px-4 z-10 w-full max-w-7xl">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
        <!-- Text Column -->
        <div class="text-left space-y-8 order-2 lg:order-1">
          <h1
            class="text-4xl md:text-7xl font-bold tracking-tight text-slate-700 leading-tight"
          >
            Mutlu Ã§ocuklar,<br />
            <span
              class="animated-underline relative inline-block whitespace-nowrap text-[#FF8A65]"
            >
              <span class="animated-underline__text relative z-10"
                >saÄŸlÄ±klÄ± yarÄ±nlar.</span
              >
              <svg
                class="animated-underline__svg absolute bottom-[-5px] left-0 w-full h-[15px] pointer-events-none"
                viewBox="0 0 400 20"
                preserveAspectRatio="none"
              >
                <path
                  d="M0,10 Q200,20 400,10"
                  fill="none"
                  class="animated-underline__path"
                  vector-effect="non-scaling-stroke"></path>
              </svg>
            </span>
          </h1>

          <p class="text-xl text-slate-500 max-w-2xl leading-relaxed">
            Pediatrik Fizyoterapist Ezgi Acem ile duyu bÃ¼tÃ¼nleme temelli
            fizyoterapi. Ã‡ocuÄŸunuzun duyusal ve motor geliÅŸimini oyunun gÃ¼cÃ¼yle
            destekleyin.
          </p>

          <div
            class="flex flex-col sm:flex-row items-center gap-4 justify-start pt-4"
          >
            <a
              href="/iletisim"
              class="hidden sm:inline-block bg-[#FF8A65] text-white px-8 py-4 rounded-full font-bold hover:bg-[#FF7043] transition shadow-lg shadow-orange-200 hover:shadow-orange-300 transform hover:-translate-y-1 duration-200 w-full sm:w-auto text-center"
            >
              Randevu AlÄ±n
            </a>
            <a
              href="/quiz"
              class="hidden md:inline-block bg-white text-slate-600 border-2 border-slate-100 px-8 py-4 rounded-full font-bold hover:border-[#FF8A65] hover:text-[#FF8A65] transition transform hover:-translate-y-1 duration-200 w-full sm:w-auto text-center"
            >
              Duyu Analizi
            </a>
          </div>
        </div>

        <!-- Image Column -->
        <div
          class="order-1 lg:order-2 flex justify-center lg:justify-end relative"
        >
          <div class="relative w-full max-w-lg aspect-square">
            <div
              class="absolute inset-0 bg-[#FF8A65]/20 rounded-[3rem] rotate-6 transform"
            >
            </div>
            <div
              class="absolute inset-0 bg-[#4DD0E1]/20 rounded-[3rem] -rotate-6 transform"
            >
            </div>
            <picture>
              <source
                type="image/webp"
                srcset="/2-pp-512w.webp 512w, /2-pp-768w.webp 768w, /2-pp-1024w.webp 1024w"
                sizes="(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 512px"
              />
              <img
                src="/2-pp.jpg"
                alt="Fizyoterapist Ezgi Acem"
                width="1066"
                height="1066"
                fetchpriority="high"
                class="relative rounded-[2.5rem] shadow-2xl object-cover w-full h-full transform transition duration-500 hover:rotate-1"
              />
            </picture>
          </div>
        </div>
      </div>
    </div>

    <!-- Scroll Indicator -->
    <div
      class="absolute bottom-8 left-1/2 transform -translate-x-1/2 text-gray-400 animate-bounce"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"><path d="M7 13l5 5 5-5M7 6l5 5 5-5"></path></svg
      >
    </div>
  </div>

  <style>
    .animated-underline {
      cursor: pointer;
    }

    .animated-underline__svg {
      /** Brand Cyan/Turquoise -> Soft Cyan */
      stroke: #4dd0e1;
      stroke-width: 4px;
      stroke-linecap: round;
      fill: none;
      overflow: visible;
    }

    /* Initial static wavy line */
    .animated-underline__path {
      d: path("M0,10 Q200,0 400,10");
      transition: all 0.3s ease;
    }

    /* Hover Animation */
    .animated-underline:hover .animated-underline__path {
      animation: underline-wobble 0.6s ease infinite;
      stroke: #ff8a65; /* Amber/Orange highlight on hover */
    }

    @keyframes underline-wobble {
      0% {
        d: path("M0,10 Q200,0 400,10");
      }
      15% {
        d: path("M0,15 Q200,-5 400,15");
      }
      30% {
        d: path("M0,5 Q200,20 400,5");
      }
      45% {
        d: path("M0,12 Q200,-2 400,12");
      }
      60% {
        d: path("M0,8 Q200,12 400,8");
      }
      75% {
        d: path("M0,11 Q200,8 400,11");
      }
      100% {
        d: path("M0,10 Q200,0 400,10");
      }
    }

    @media (max-width: 768px) {
      .animated-underline__svg {
        display: none;
      }
    }
  </style>

  <!-- Treatment Process Section -->
  <TreatmentProcess />

  <!-- Services Section -->
  <section class="py-20 relative overflow-hidden bg-transparent">
    <!-- Mesh Gradient Background Removed (Global used instead) -->

    <div class="container mx-auto px-6 md:px-12 max-w-7xl relative z-10">
      <h2 class="text-3xl font-bold text-center mb-12 text-slate-700">
        Neler YapÄ±yoruz? - Hizmetlerimiz
      </h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
        {
          [
            {
              icon: "ðŸ§©",
              title: "Duyu BÃ¼tÃ¼nleme Terapisi",
              desc: "Ã‡ocuÄŸunuzun duyusal uyaranlarÄ± doÄŸru iÅŸlemesine yardÄ±mcÄ± olarak Ã¶ÄŸrenme, dikkat ve davranÄ±ÅŸ becerilerini geliÅŸtiriyoruz.",
              color: "bg-orange-50 border-orange-100",
              titleColor: "text-orange-500",
            },
            {
              icon: "ðŸŽˆ",
              title: "Pediatrik Rehabilitasyon",
              desc: "Serebral Palsi, Spina Bifida ve diÄŸer nÃ¶rogeliÅŸimsel durumlarda fonksiyonel kapasiteyi artÄ±rmaya yÃ¶nelik Ã¶zel yaklaÅŸÄ±mlar.",
              color: "bg-blue-50 border-blue-100",
              titleColor: "text-blue-500",
            },
            {
              icon: "ðŸ‘¶",
              title: "Erken MÃ¼dahale & Takip",
              desc: "Riskli bebeklerde motor geliÅŸim takibi ve gecikilen alanlarda aileyi de sÃ¼rece dahil eden destekleyici programlar.",
              color: "bg-green-50 border-green-100",
              titleColor: "text-green-500",
            },
            {
              icon: "ðŸƒâ€â™‚ï¸",
              title: "Pediatrik Fizyoterapi",
              desc: "Kas-iskelet sistemi ve postÃ¼r bozukluklarÄ±nda Ã§ocuÄŸunuza Ã¶zel egzersiz ve manuel terapi odaklÄ± yaklaÅŸÄ±mlar.",
              color: "bg-purple-50 border-purple-100",
              titleColor: "text-purple-500",
            },
          ].map((service) => (
            <div
              class={`p-8 rounded-3xl bg-white/70 backdrop-blur-xl border border-white/50 shadow-lg hover:shadow-xl hover:bg-white/90 hover:-translate-y-1 transition-all duration-500 ${service.color}`}
            >
              <div class="text-5xl mb-6">{service.icon}</div>
              <h3 class={`text-xl font-bold mb-3 ${service.titleColor}`}>
                {service.title}
              </h3>
              <p class="text-slate-600 leading-relaxed">{service.desc}</p>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <!-- FAQ Section -->
  <section class="py-20 relative overflow-hidden bg-white/50">
    <div class="container mx-auto px-6 md:px-12 max-w-7xl relative z-10">
      <div class="text-center mb-12">
        <span
          class="text-[#FF8A65] font-bold tracking-wider uppercase text-sm mb-2 block"
          >Merak Ettikleriniz</span
        >
        <h2 class="text-3xl md:text-4xl font-bold text-slate-700">
          SÄ±kÃ§a Sorulan Sorular
        </h2>
      </div>
      <FAQ client:visible />
    </div>
  </section>

  <!-- Recent Blog Posts -->
  <section class="py-20 relative overflow-hidden bg-transparent">
    <!-- Mesh Gradient Background Removed -->

    <div class="container mx-auto px-6 md:px-12 max-w-7xl relative z-10">
      <div class="flex justify-between items-end mb-12">
        <div>
          <h2 class="text-3xl font-bold text-slate-700 mb-2">GÃ¼ncel YazÄ±lar</h2>
          <p class="text-slate-500">
            SaÄŸlÄ±k ve rehabilitasyon hakkÄ±nda son paylaÅŸÄ±mlar.
          </p>
        </div>
        <a
          href="/blog"
          class="text-[#FF8A65] font-bold hover:underline flex items-center gap-1"
        >
          TÃ¼mÃ¼nÃ¼ GÃ¶r <span>&rarr;</span>
        </a>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        {
          latestPosts.length > 0 ? (
            latestPosts.map((post) => (
              <article class="bg-white/70 backdrop-blur-xl border border-white/50 shadow-lg hover:shadow-xl hover:bg-white/90 hover:-translate-y-1 transition-all duration-500 rounded-3xl overflow-hidden group">
                <a
                  href={`/blog/${post.slug}`}
                  class="block h-56 bg-orange-50 overflow-hidden relative flex items-center justify-center"
                >
                  {post.image ? (
                    <Image
                      src={getPbImageURL(
                        post.collectionId,
                        post.id,
                        post.image,
                      )}
                      alt={post.title}
                      width={400}
                      height={225}
                      format="webp"
                      class="w-full h-full object-cover hover:scale-105 transition duration-500"
                    />
                  ) : (
                    <div class="w-full h-full flex items-center justify-center text-orange-300 bg-orange-50 font-bold">
                      GÃ¶rsel Yok
                    </div>
                  )}
                </a>
                <div class="p-6">
                  <span class="text-xs font-bold text-orange-500 bg-orange-100 px-3 py-1 rounded-full uppercase tracking-wider">
                    {post.category}
                  </span>
                  <h3 class="text-xl font-bold mt-4 mb-3 text-slate-700 group-hover:text-[#FF8A65] transition leading-tight">
                    <a href={`/blog/${post.slug}`}>{post.title}</a>
                  </h3>
                  <p class="text-slate-500 text-sm line-clamp-2 leading-relaxed">
                    {post.summary}
                  </p>
                  <div class="mt-4 text-xs font-medium text-slate-400 flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-slate-300" />
                    {new Date(post.published_date).toLocaleDateString("tr-TR", {
                      day: "numeric",
                      month: "long",
                      year: "numeric",
                    })}
                  </div>
                </div>
              </article>
            ))
          ) : (
            <div class="col-span-3 text-center py-12 text-slate-400 bg-white rounded-3xl border-2 border-dashed border-slate-200">
              HenÃ¼z yazÄ± bulunmuyor.
            </div>
          )
        }
      </div>
    </div>
  </section>
</BaseLayout>
